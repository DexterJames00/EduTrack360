<!DOCTYPE html>
<html>
<head>
    <title>Real-time Logs Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
</head>
<body>
    <h1>Real-time Logs Test</h1>
    <div id="logs"></div>
    <button onclick="testSocket()">Test Socket.IO</button>
    
    <script>
        console.log('üöÄ Starting real-time logs test...');
        
        const schoolId = 1;
        let socketConnected = false;
        
        // BULLETPROOF Socket.IO connection
        const socket = io('http://192.168.0.111:5000', {
            transports: ['polling', 'websocket'],
            timeout: 5000,
            forceNew: true
        });
        
        socket.on('connect', function() {
            console.log('‚úÖ Socket.IO connected!');
            socketConnected = true;
            document.getElementById('logs').innerHTML += '<div>‚úÖ Connected to Socket.IO</div>';
            
            socket.emit('join_school_room', {school_id: schoolId});
            console.log('üè† Joined school room');
        });
        
        socket.on('new_activity_log', function(data) {
            console.log('üéâ NEW ACTIVITY LOG:', data);
            document.getElementById('logs').innerHTML += '<div>üéâ New Log: ' + JSON.stringify(data) + '</div>';
        });
        
        socket.on('connect_error', function(error) {
            console.log('‚ùå Connection error:', error);
            document.getElementById('logs').innerHTML += '<div>‚ùå Connection error</div>';
        });
        
        function testSocket() {
            if (socket && socketConnected) {
                socket.emit('test_logs_dashboard', {school_id: schoolId});
                console.log('üß™ Sent test event');
            }
        }
    </script>
</body>
</html>